<!DOCTYPE html>
<html>
<head>
    <title>智能班级管理系统</title>
    <style>
        :root { --primary: #4CAF50; --secondary: #2196F3; }
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 20px auto; padding: 20px; }
        .section { border: 2px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 10px; }
        .student-card { display: flex; align-items: center; padding: 15px; margin: 10px 0; background: #f8f9fa; }
        .avatar { width: 60px; height: 60px; border-radius: 50%; margin-right: 15px; object-fit: cover; }
        button { padding: 8px 15px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .primary-btn { background: var(--primary); color: white; }
        .secondary-btn { background: var(--secondary); color: white; }
        .red-btn { background: #ff4444; color: white; }
        input, select { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>📚 智能班级管理系统 v2.0</h1>

    <!-- 班级管理区 -->
    <div class="section">
        <h2>🏫 班级设置</h2>
        <input type="text" id="className" placeholder="输入班级名称">
        <button class="primary-btn" onclick="saveClassInfo()">保存班级</button>
    </div>

    <!-- 学生管理区 -->
    <div class="section">
        <h2>👥 学生管理</h2>
        <div id="studentsContainer"></div>
        <div style="margin-top:20px">
            <input type="text" id="newName" placeholder="姓名">
            <input type="number" id="newNumber" placeholder="座号">
            <input type="text" id="newAvatar" placeholder="头像URL">
            <button class="primary-btn" onclick="addStudent()">添加学生</button>
        </div>
    </div>

    <!-- 积分系统区 -->
    <div class="section">
        <h2>⭐ 积分系统</h2>
        <div>
            <select id="ruleType">
                <option value="reward">奖励规则</option>
                <option value="punish">处罚规则</option>
            </select>
            <input type="text" id="ruleName" placeholder="规则名称">
            <input type="number" id="rulePoints" placeholder="分值">
            <button class="secondary-btn" onclick="addRule()">添加规则</button>
        </div>
        <div id="pointsDisplay" style="margin-top:15px"></div>
    </div>

    <!-- 作业与考勤区 -->
    <div class="section">
        <h2>📅 作业与考勤</h2>
        <div>
            <input type="text" id="assignmentName" placeholder="作业名称">
            <input type="datetime-local" id="assignmentDeadline">
            <button class="primary-btn" onclick="createAssignment()">布置作业</button>
        </div>
        <div id="assignmentsList" style="margin-top:15px"></div>
    </div>

    <script>
       // 数据保存函数
function saveData() {
    localStorage.setItem('classData', JSON.stringify(appData));
    loadAllData();
}

// 加载所有数据
function loadAllData() {
    // 加载班级信息
    document.getElementById('className').value = appData.className;

    // 加载学生列表
    let studentsHTML = '';
    appData.students.forEach((student, index) => {
        studentsHTML += `
        <div class="student-card">
            <img src="${student.avatar || 'https://via.placeholder.com/60'}" 
                 class="avatar" 
                 alt="${student.name}的头像">
            <div style="flex-grow:1">
                <h3>${student.number}号 ${student.name}</h3>
                <p>当前积分：${student.points || 0}</p>
                <button class="secondary-btn" 
                        onclick="adjustPoints(${index}, 1)">+1</button>
                <button class="secondary-btn" 
                        onclick="adjustPoints(${index}, -1)">-1</button>
                <button class="red-btn" 
                        onclick="deleteStudent(${index})">删除</button>
            </div>
        </div>`;
    });
    document.getElementById('studentsContainer').innerHTML = studentsHTML;

    // 加载积分规则
    let rulesHTML = '<h3>当前规则：</h3>';
    appData.pointRules.forEach(rule => {
        rulesHTML += `
        <div style="margin:5px; padding:5px; background:#eee">
            ${rule.type === 'reward' ? '🎉' : '⚠️'} 
            ${rule.name}：${rule.points}分
        </div>`;
    });
    document.getElementById('pointsDisplay').innerHTML = rulesHTML;

    // 加载作业列表
    let assignmentsHTML = '';
    appData.assignments.forEach((assn, index) => {
        const deadline = new Date(assn.deadline);
        const now = new Date();
        const status = deadline < now ? '🟥 已逾期' : '🟩 进行中';
        
        assignmentsHTML += `
        <div style="margin:10px 0; padding:10px; border-left:4px solid ${status.includes('逾期') ? 'red' : 'green'}">
            <b>${assn.name}</b> - 截止时间：${deadline.toLocaleString()}
            <br>状态：${status}
        </div>`;
    });
    document.getElementById('assignmentsList').innerHTML = assignmentsHTML;
}

// 学生管理功能
function addStudent() {
    const name = document.getElementById('newName').value;
    const number = document.getElementById('newNumber').value;
    const avatar = document.getElementById('newAvatar').value;
    
    if(name && number) {
        appData.students.push({
            name,
            number,
            avatar,
            points: 0
        });
        saveData();
        document.getElementById('newName').value = '';
        document.getElementById('newNumber').value = '';
        document.getElementById('newAvatar').value = '';
    }
}

function deleteStudent(index) {
    if(confirm('确定要删除该学生吗？')) {
        appData.students.splice(index, 1);
        saveData();
    }
}

// 积分管理功能
function adjustPoints(index, delta) {
    appData.students[index].points += delta;
    saveData();
}

function addRule() {
    const type = document.getElementById('ruleType').value;
    const name = document.getElementById('ruleName').value;
    const points = parseInt(document.getElementById('rulePoints').value);
    
    if(name && !isNaN(points)) {
        appData.pointRules.push({ type, name, points });
        saveData();
        document.getElementById('ruleName').value = '';
        document.getElementById('rulePoints').value = '';
    }
}

// 作业管理功能
function createAssignment() {
    const name = document.getElementById('assignmentName').value;
    const deadline = document.getElementById('assignmentDeadline').value;
    
    if(name && deadline) {
        appData.assignments.push({
            name,
            deadline,
            submissions: {}
        });
        saveData();
        document.getElementById('assignmentName').value = '';
        document.getElementById('assignmentDeadline').value = '';
    }
}

// 初始化加载
document.addEventListener('DOMContentLoaded', loadAllData);
    </script>
</body>
</html>
