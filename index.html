<!DOCTYPE html>
<html>
<head>
    <title>æ™ºèƒ½ç­çº§ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #4CAF50; --secondary: #2196F3; }
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 20px auto; padding: 20px; }
        .section { border: 2px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 10px; }
        .student-card { display: flex; align-items: center; padding: 15px; margin: 10px 0; background: #f8f9fa; }
        .avatar { width: 60px; height: 60px; border-radius: 50%; margin-right: 15px; object-fit: cover; }
        button { padding: 8px 15px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .primary-btn { background: var(--primary); color: white; }
        .secondary-btn { background: var(--secondary); color: white; }
        .red-btn { background: #ff4444; color: white; }
        input, select { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸ“š æ™ºèƒ½ç­çº§ç®¡ç†ç³»ç»Ÿ v2.0</h1>

    <!-- ç­çº§ç®¡ç†åŒº -->
    <div class="section">
        <h2>ğŸ« ç­çº§è®¾ç½®</h2>
        <input type="text" id="className" placeholder="è¾“å…¥ç­çº§åç§°">
        <button class="primary-btn" onclick="saveClassInfo()">ä¿å­˜ç­çº§</button>
    </div>

    <!-- å­¦ç”Ÿç®¡ç†åŒº -->
    <div class="section">
        <h2>ğŸ‘¥ å­¦ç”Ÿç®¡ç†</h2>
        <div id="studentsContainer"></div>
        <div style="margin-top:20px">
            <input type="text" id="newName" placeholder="å§“å">
            <input type="number" id="newNumber" placeholder="åº§å·">
            <input type="text" id="newAvatar" placeholder="å¤´åƒURL">
            <button class="primary-btn" onclick="addStudent()">æ·»åŠ å­¦ç”Ÿ</button>
        </div>
    </div>

    <!-- ç§¯åˆ†ç³»ç»ŸåŒº -->
    <div class="section">
        <h2>â­ ç§¯åˆ†ç³»ç»Ÿ</h2>
        <div>
            <select id="ruleType">
                <option value="reward">å¥–åŠ±è§„åˆ™</option>
                <option value="punish">å¤„ç½šè§„åˆ™</option>
            </select>
            <input type="text" id="ruleName" placeholder="è§„åˆ™åç§°">
            <input type="number" id="rulePoints" placeholder="åˆ†å€¼">
            <button class="secondary-btn" onclick="addRule()">æ·»åŠ è§„åˆ™</button>
        </div>
        <div id="pointsDisplay" style="margin-top:15px"></div>
    </div>

    <!-- ä½œä¸šä¸è€ƒå‹¤åŒº -->
    <div class="section">
        <h2>ğŸ“… ä½œä¸šä¸è€ƒå‹¤</h2>
        <div>
            <input type="text" id="assignmentName" placeholder="ä½œä¸šåç§°">
            <input type="datetime-local" id="assignmentDeadline">
            <button class="primary-btn" onclick="createAssignment()">å¸ƒç½®ä½œä¸š</button>
        </div>
        <div id="assignmentsList" style="margin-top:15px"></div>
    </div>

    <script>
       // æ•°æ®ä¿å­˜å‡½æ•°
function saveData() {
    localStorage.setItem('classData', JSON.stringify(appData));
    loadAllData();
}

// åŠ è½½æ‰€æœ‰æ•°æ®
function loadAllData() {
    // åŠ è½½ç­çº§ä¿¡æ¯
    document.getElementById('className').value = appData.className;

    // åŠ è½½å­¦ç”Ÿåˆ—è¡¨
    let studentsHTML = '';
    appData.students.forEach((student, index) => {
        studentsHTML += `
        <div class="student-card">
            <img src="${student.avatar || 'https://via.placeholder.com/60'}" 
                 class="avatar" 
                 alt="${student.name}çš„å¤´åƒ">
            <div style="flex-grow:1">
                <h3>${student.number}å· ${student.name}</h3>
                <p>å½“å‰ç§¯åˆ†ï¼š${student.points || 0}</p>
                <button class="secondary-btn" 
                        onclick="adjustPoints(${index}, 1)">+1</button>
                <button class="secondary-btn" 
                        onclick="adjustPoints(${index}, -1)">-1</button>
                <button class="red-btn" 
                        onclick="deleteStudent(${index})">åˆ é™¤</button>
            </div>
        </div>`;
    });
    document.getElementById('studentsContainer').innerHTML = studentsHTML;

    // åŠ è½½ç§¯åˆ†è§„åˆ™
    let rulesHTML = '<h3>å½“å‰è§„åˆ™ï¼š</h3>';
    appData.pointRules.forEach(rule => {
        rulesHTML += `
        <div style="margin:5px; padding:5px; background:#eee">
            ${rule.type === 'reward' ? 'ğŸ‰' : 'âš ï¸'} 
            ${rule.name}ï¼š${rule.points}åˆ†
        </div>`;
    });
    document.getElementById('pointsDisplay').innerHTML = rulesHTML;

    // åŠ è½½ä½œä¸šåˆ—è¡¨
    let assignmentsHTML = '';
    appData.assignments.forEach((assn, index) => {
        const deadline = new Date(assn.deadline);
        const now = new Date();
        const status = deadline < now ? 'ğŸŸ¥ å·²é€¾æœŸ' : 'ğŸŸ© è¿›è¡Œä¸­';
        
        assignmentsHTML += `
        <div style="margin:10px 0; padding:10px; border-left:4px solid ${status.includes('é€¾æœŸ') ? 'red' : 'green'}">
            <b>${assn.name}</b> - æˆªæ­¢æ—¶é—´ï¼š${deadline.toLocaleString()}
            <br>çŠ¶æ€ï¼š${status}
        </div>`;
    });
    document.getElementById('assignmentsList').innerHTML = assignmentsHTML;
}

// å­¦ç”Ÿç®¡ç†åŠŸèƒ½
function addStudent() {
    const name = document.getElementById('newName').value;
    const number = document.getElementById('newNumber').value;
    const avatar = document.getElementById('newAvatar').value;
    
    if(name && number) {
        appData.students.push({
            name,
            number,
            avatar,
            points: 0
        });
        saveData();
        document.getElementById('newName').value = '';
        document.getElementById('newNumber').value = '';
        document.getElementById('newAvatar').value = '';
    }
}

function deleteStudent(index) {
    if(confirm('ç¡®å®šè¦åˆ é™¤è¯¥å­¦ç”Ÿå—ï¼Ÿ')) {
        appData.students.splice(index, 1);
        saveData();
    }
}

// ç§¯åˆ†ç®¡ç†åŠŸèƒ½
function adjustPoints(index, delta) {
    appData.students[index].points += delta;
    saveData();
}

function addRule() {
    const type = document.getElementById('ruleType').value;
    const name = document.getElementById('ruleName').value;
    const points = parseInt(document.getElementById('rulePoints').value);
    
    if(name && !isNaN(points)) {
        appData.pointRules.push({ type, name, points });
        saveData();
        document.getElementById('ruleName').value = '';
        document.getElementById('rulePoints').value = '';
    }
}

// ä½œä¸šç®¡ç†åŠŸèƒ½
function createAssignment() {
    const name = document.getElementById('assignmentName').value;
    const deadline = document.getElementById('assignmentDeadline').value;
    
    if(name && deadline) {
        appData.assignments.push({
            name,
            deadline,
            submissions: {}
        });
        saveData();
        document.getElementById('assignmentName').value = '';
        document.getElementById('assignmentDeadline').value = '';
    }
}

// åˆå§‹åŒ–åŠ è½½
document.addEventListener('DOMContentLoaded', loadAllData);
    </script>
</body>
</html>
